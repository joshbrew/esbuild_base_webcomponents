(()=>{var g=Object.defineProperty;var f=(i,e,s)=>e in i?g(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s;var m=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var r=(i,e,s)=>(f(i,typeof e!="symbol"?e+"":e,s),s);var a=m((z,w)=>{w.exports=`<div>Test worked!</div>\r
<button>Clickme</button>`});var p=class extends HTMLElement{constructor(){super();r(this,"template",e=>`<div> Custom Fragment Props: ${JSON.stringify(e)} </div>`);r(this,"props",{test:!0});r(this,"oncreate");r(this,"onresize");r(this,"ondelete");r(this,"onchanged");r(this,"fragment");r(this,"delete",()=>{this.fragment=void 0,this.remove(),this.ondelete&&this.ondelete(this.props)});r(this,"render",(e=this.props)=>{typeof this.template=="function"?this.templateString=this.template(e):this.templateString=this.template;let s=document.createElement("template");s.innerHTML=this.templateString;let n=s.content;this.fragment&&this.removeChild(this.fragment),this.fragment=n,this.appendChild(n),this.oncreate&&this.oncreate(e)});r(this,"state",{pushToState:{},data:{},triggers:{},setState(e){if(Object.assign(this.pushToState,e),Object.keys(this.triggers).length>0)for(let s of Object.getOwnPropertyNames(this.triggers))this.pushToState[s]&&(this.data[s]=this.pushToState[s],delete this.pushToState[s],this.triggers[s].forEach(n=>{n.onchanged(this.data[s])}));return this.pushToState},subscribeTrigger(e,s=n=>{}){if(e){this.triggers[e]||(this.triggers[e]=[]);let n=this.triggers[e].length;return this.triggers[e].push({idx:n,onchanged:s}),this.triggers[e].length-1}else return},unsubscribeTrigger(e,s){let n,t=this.triggers[e];if(t)if(!s)delete this.triggers[e];else return t.find(l=>{if(l.idx===s)return!0})&&t.splice(n,1),!0},subscribeTriggerOnce(e=void 0,s=n=>{}){let n,t=o=>{s(o),this.unsubscribeTrigger(e,n)};n=this.subscribeTrigger(e,t)}})}attributeChangedCallback(e,s,n){if(e==="onchanged"){let t=n;typeof t=="string"&&(t=d(t)),typeof t=="function"&&(this.onchanged=t,this.state.data.props=this.props,this.state.unsubscribeTrigger("props"),this.state.subscribeTrigger("props",this.onchanged))}if(e==="onresize"){let t=n;if(typeof t=="string"&&(t=d(t)),typeof t=="function"){try{window.removeEventListener("resize",this.onresize)}catch(o){}this.onresize=t,window.addEventListener("resize",this.onresize)}}if(e==="ondelete"){let t=n;typeof t=="string"&&(t=d(t)),typeof t=="function"&&(this.ondelete=()=>{window.removeEventListener("resize",this.onresize),this.state.unsubscribeTrigger("props"),t()})}if(e==="oncreate"){let t=n;typeof t=="string"&&(t=d(t)),typeof t=="function"&&(this.oncreate=t)}if(e==="props"){let t=n;typeof t=="string"&&(t=JSON.parse(t)),Object.assign(this.props,t),this.state.setState({props:this.props})}if(e==="template"){let t=n;this.template=options.template,typeof t=="function"?this.templateString=this.template(this.props):this.templateString=t;let o=new CustomEvent("created",{detail:{props:this.props}});this.render(this.props),this.dispatchEvent(o)}}connectedCallback(){let e=new CustomEvent("resized",{detail:{props:this.props}}),s=new CustomEvent("changed",{detail:{props:this.props}}),n=new CustomEvent("deleted",{detail:{props:this.props}}),t=new CustomEvent("created",{detail:{props:this.props}});if(this.render(this.props),this.dispatchEvent(t),this.state.subscribeTrigger("props",()=>{this.dispatchEvent(s)}),typeof this.onresize=="function"&&window.addEventListener("resize",()=>{this.onresize(),this.dispatchEvent(e)}),typeof this.ondelete=="function"){let o=this.ondelete;this.ondelete=()=>{window.removeEventListener("resize",this.onresize),this.state.unsubscribeTrigger("props"),o(),this.dispatchEvent(n)}}typeof this.onchanged=="function"&&(this.state.data.props=this.props,this.state.subscribeTrigger("props",this.onchanged))}get props(){return this.props}set props(e={}){this.setAttribute("props",e)}get template(){return this.template}set template(e){this.setAttribute("template",e)}get render(){return this.render}get delete(){return this.delete}get state(){return this.state}get onchanged(){return this.onchanged}set onchanged(e){this.setAttribute("onchanged",e)}get onresize(){return this.props}set onresize(e){this.setAttribute("onresize",e)}get ondelete(){return this.props}set ondelete(e){this.setAttribute("ondelete",e)}get oncreate(){return this.oncreate}set oncreate(e){this.setAttribute("oncreated",e)}};r(p,"observedAttributes",["props","options","onchanged","onresize","ondelete","oncreate","template"]);function h(i,e,s=null){s?e?window.customElements.define(e,i,{extends:s}):window.customElements.define(i.name.toLowerCase()+"-",i,{extends:s}):e?window.customElements.define(e,i):window.customElements.define(i.name.toLowerCase()+"-",i)}function F(i=""){return i+Math.floor(Math.random()*1e15)}function d(method){let getFunctionBody=i=>i.replace(/^\W*(function[^{]+\{([\s\S]*)\}|[^=]+=>[^{]*\{([\s\S]*)\}|[^=]+=>(.+))/i,"$2$3$4"),getFunctionHead=i=>{let e=i.indexOf(")");return i.slice(0,i.indexOf("{",e)+1)},newFuncHead=getFunctionHead(method),newFuncBody=getFunctionBody(method),newFunc;if(newFuncHead.includes("function ")){let i=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(i,newFuncBody)}else if(newFuncHead.substring(0,6)===newFuncBody.substring(0,6)){let i=newFuncHead.split("(")[1].split(")")[0];newFunc=new Function(i,newFuncBody.substring(newFuncBody.indexOf("{")+1,newFuncBody.length-1))}else newFunc=eval(newFuncHead+newFuncBody+"}");return newFunc}var b=a(),u=class extends p{constructor(){super(...arguments);r(this,"props",{});r(this,"template",b);r(this,"oncreate",e=>{let s=this.querySelector("button"),n=this.querySelector("div");s&&(s.onclick=t=>{n.innerHTML="Clicked!"})})}};h(u,"custom-");var c=document.createElement("custom-");console.log("custom element:",c,c.__proto__);})();
//# sourceMappingURL=app.js.map
